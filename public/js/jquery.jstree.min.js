"use strict";(function(b){b.vakata={};b.vakata.css={get_css:function(g,j,i){g=g.toLowerCase();var h=i.cssRules||i.rules,a=0;do{if(h.length&&a>h.length+5){return false}if(h[a].selectorText&&h[a].selectorText.toLowerCase()==g){if(j===true){if(i.removeRule){i.removeRule(a)}if(i.deleteRule){i.deleteRule(a)}return true}else{return h[a]}}}while(h[++a]);return false},add_css:function(d,a){if(b.jstree.css.get_css(d,false,a)){return false}if(a.insertRule){a.insertRule(d+" { }",0)}else{a.addRule(d,null,0)}return b.vakata.css.get_css(d)},remove_css:function(d,a){return b.vakata.css.get_css(d,true,a)},add_sheet:function(f){var a;if(f.str){a=document.createElement("style");a.setAttribute("type","text/css");if(a.styleSheet){document.getElementsByTagName("head")[0].appendChild(a);a.styleSheet.cssText=f.str}else{a.appendChild(document.createTextNode(f.str));document.getElementsByTagName("head")[0].appendChild(a)}return a.sheet||a.styleSheet}if(f.url){if(document.createStyleSheet){try{a=document.createStyleSheet(f.url)}catch(e){}}else{a=document.createElement("link");a.rel="stylesheet";a.type="text/css";a.media="all";a.href=f.url;document.getElementsByTagName("head")[0].appendChild(a);return a.styleSheet}}}}})(jQuery);(function(j){var i=[],l=-1,g={},h={},k=false;j.fn.jstree=function(a){var d=(typeof a=="string"),c=Array.prototype.slice.call(arguments,1),b=this;if(!d&&j.meta){c.push(j.metadata.get(this).jstree)}a=!d&&c.length?j.extend.apply(null,[true,a].concat(c)):a;if(d&&a.substring(0,1)=="_"){return b}if(d){this.each(function(){var f=i[j.data(this,"jstree-instance-id")],e=(f&&j.isFunction(f[a]))?f[a].apply(f,c):f;if(typeof e!=="undefined"&&(a.indexOf("is_"===0)||(e!==true&&e!==false))){b=e;return false}})}else{this.each(function(){var e=j.data(this,"jstree-instance-id"),f=false;if(typeof e!=="undefined"&&i[e]){i[e].destroy()}e=parseInt(i.push({}),10)-1;j.data(this,"jstree-instance-id",e);if(!a){a={}}a.plugins=j.isArray(a.plugins)?a.plugins:j.jstree.defaults.plugins;if(j.inArray("core",a.plugins)===-1){a.plugins.unshift("core")}f=j.extend(true,{},j.jstree.defaults,a);f.plugins=a.plugins;j.each(g,function(o,p){if(j.inArray(o,f.plugins)===-1){f[o]=null;delete f[o]}});i[e]=new j.jstree._instance(e,j(this).addClass("jstree jstree-"+e),f);j.each(i[e]._get_settings().plugins,function(o,p){i[e].data[p]={}});j.each(i[e]._get_settings().plugins,function(o,p){if(g[p]){g[p].__init.apply(i[e])}});i[e].init()})}return b};j.jstree={defaults:{plugins:[]},_focused:function(){return i[l]||null},_reference:function(b){if(i[b]){return i[b]}var a=j(b);if(!a.length&&typeof b==="string"){a=j("#"+b)}if(!a.length){return null}return i[a.closest(".jstree").data("jstree-instance-id")]||null},_instance:function(b,c,a){this.data={core:{}};this.get_settings=function(){return j.extend(true,{},a)};this._get_settings=function(){return a};this.get_index=function(){return b};this.get_container=function(){return c};this._set_settings=function(d){a=j.extend(true,{},a,d)}},_fn:{},plugin:function(b,a){a=j.extend({},{__init:j.noop,__destroy:j.noop,_fn:{},defaults:false},a);g[b]=a;j.jstree.defaults[b]=a.defaults;j.each(a._fn,function(d,c){c.plugin=b;c.old=j.jstree._fn[d];j.jstree._fn[d]=function(){var p,e=c,f=Array.prototype.slice.call(arguments),q=new j.Event("before.jstree"),r=false;do{if(e&&e.plugin&&j.inArray(e.plugin,this._get_settings().plugins)!==-1){break}e=e.old}while(e);if(!e){return}p=this.get_container().triggerHandler(q,{func:d,inst:this,args:f});if(p===false){return}if(typeof p!=="undefined"){f=p}if(d.indexOf("_")===0){p=e.apply(this,f)}else{p=e.apply(j.extend({},this,{__callback:function(m){this.get_container().triggerHandler(d+".jstree",{inst:this,args:f,rslt:m,rlbk:r})},__rollback:function(){r=this.get_rollback();return r},__call_old:function(m){return e.old.apply(this,(m?Array.prototype.slice.call(arguments,1):f))}}),f)}return p};j.jstree._fn[d].old=c.old;j.jstree._fn[d].plugin=b})},rollback:function(a){if(a){if(!j.isArray(a)){a=[a]}j.each(a,function(c,b){i[b.i].set_rollback(b.h,b.d)})}}};j.jstree._fn=j.jstree._instance.prototype={};j(function(){var a=navigator.userAgent.toLowerCase(),b=(a.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],c=".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .jstree-icon { margin-right:3px; } .jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";if(/msie/.test(a)&&parseInt(b,10)==6){k=true;c+=".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "}if(/msie/.test(a)&&parseInt(b,10)==7){c+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } "}j.vakata.css.add_sheet({str:c})});j.jstree.plugin("core",{__init:function(){this.data.core.to_open=j.map(j.makeArray(this.get_settings().core.initially_open),function(a){return"#"+a.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/")})},defaults:{html_titles:false,animation:500,initially_open:[],rtl:false,strings:{loading:"Loading ...",new_node:"New node"}},_fn:{init:function(){this.set_focus();if(this._get_settings().core.rtl){this.get_container().addClass("jstree-rtl").css("direction","rtl")}this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+this._get_settings().core.strings.loading+"</a></li></ul>");this.data.core.li_height=this.get_container().find("ul li.jstree-closed, ul li.jstree-leaf").eq(0).height()||18;this.get_container().delegate("li > ins","click.jstree",j.proxy(function(a){var b=j(a.target);if(b.is("ins")&&a.pageY-b.offset().top<this.data.core.li_height){this.toggle_node(b)}},this)).bind("mousedown.jstree",j.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(b){var a;if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){a=window.getSelection();try{a.removeAllRanges();a.collapse()}catch(c){}}}});this.__callback();this.load_node(-1,function(){this.loaded();this.reopen()})},destroy:function(){var d,a=this.get_index(),c=this._get_settings(),b=this;j.each(c.plugins,function(f,o){try{g[o].__destroy.apply(b)}catch(e){}});this.__callback();if(this.is_focused()){for(d in i){if(i.hasOwnProperty(d)&&d!=a){i[d].set_focus();break}}}if(a===l){l=-1}this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree-instance-id").find("[class^='jstree']").andSelf().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")});i[a]=null;delete i[a]},save_opened:function(){var a=this;this.data.core.to_open=[];this.get_container().find(".jstree-open").each(function(){a.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/"))});this.__callback(a.data.core.to_open)},reopen:function(d){var a=this,e=true,b=[],c=[];if(!d){this.data.core.reopen=false;this.data.core.refreshing=true}if(this.data.core.to_open.length){j.each(this.data.core.to_open,function(n,f){if(f=="#"){return true}if(j(f).length&&j(f).is(".jstree-closed")){b.push(f)}else{c.push(f)}});if(b.length){this.data.core.to_open=c;j.each(b,function(n,f){a.open_node(f,function(){a.reopen(true)},true)});e=false}}if(e){if(this.data.core.reopen){clearTimeout(this.data.core.reopen)}this.data.core.reopen=setTimeout(function(){a.__callback({},a)},50);this.data.core.refreshing=false}},refresh:function(b){var a=this;this.save_opened();if(!b){b=-1}b=this._get_node(b);if(!b){b=-1}if(b!==-1){b.children("UL").remove()}this.load_node(b,function(){a.__callback({obj:b});a.reopen()})},loaded:function(){this.__callback()},set_focus:function(){var a=j.jstree._focused();if(a&&a!==this){a.get_container().removeClass("jstree-focused")}if(a!==this){this.get_container().addClass("jstree-focused");l=this.get_index()}this.__callback()},is_focused:function(){return l==this.get_index()},_get_node:function(b){var a=j(b,this.get_container());if(a.is(".jstree")||b==-1){return -1}a=a.closest("li",this.get_container());return a.length?a:false},_get_next:function(a,b){a=this._get_node(a);if(a===-1){return this.get_container().find("> ul > li:first-child")}if(!a.length){return false}if(b){return(a.nextAll("li").size()>0)?a.nextAll("li:eq(0)"):false}if(a.hasClass("jstree-open")){return a.find("li:eq(0)")}else{if(a.nextAll("li").size()>0){return a.nextAll("li:eq(0)")}else{return a.parentsUntil(".jstree","li").next("li").eq(0)}}},_get_prev:function(b,c){b=this._get_node(b);if(b===-1){return this.get_container().find("> ul > li:last-child")}if(!b.length){return false}if(c){return(b.prevAll("li").length>0)?b.prevAll("li:eq(0)"):false}if(b.prev("li").length){b=b.prev("li").eq(0);while(b.hasClass("jstree-open")){b=b.children("ul:eq(0)").children("li:last")}return b}else{var a=b.parentsUntil(".jstree","li:eq(0)");return a.length?a:false}},_get_parent:function(b){b=this._get_node(b);if(b==-1||!b.length){return false}var a=b.parentsUntil(".jstree","li:eq(0)");return a.length?a:-1},_get_children:function(a){a=this._get_node(a);if(a===-1){return this.get_container().children("ul:eq(0)").children("li")}if(!a.length){return false}return a.children("ul:eq(0)").children("li")},get_path:function(b,d){var c=[],a=this;b=this._get_node(b);if(b===-1||!b||!b.length){return false}b.parentsUntil(".jstree","li").each(function(){c.push(d?this.id:a.get_text(this))});c.reverse();c.push(d?b.attr("id"):this.get_text(b));return c},is_open:function(a){a=this._get_node(a);return a&&a!==-1&&a.hasClass("jstree-open")},is_closed:function(a){a=this._get_node(a);return a&&a!==-1&&a.hasClass("jstree-closed")},is_leaf:function(a){a=this._get_node(a);return a&&a!==-1&&a.hasClass("jstree-leaf")},open_node:function(b,a,d){b=this._get_node(b);if(!b.length){return false}if(!b.hasClass("jstree-closed")){if(a){a.call()}return false}var c=d||k?0:this._get_settings().core.animation,e=this;if(!this._is_loaded(b)){b.children("a").addClass("jstree-loading");this.load_node(b,function(){e.open_node(b,a,d)},a)}else{if(c){b.children("ul").css("display","none")}b.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading");if(c){b.children("ul").stop(true).slideDown(c,function(){this.style.display=""})}this.__callback({obj:b});if(a){a.call()}}},close_node:function(a,c){a=this._get_node(a);var b=c||k?0:this._get_settings().core.animation;if(!a.length||!a.hasClass("jstree-open")){return false}if(b){a.children("ul").attr("style","display:block !important")}a.removeClass("jstree-open").addClass("jstree-closed");if(b){a.children("ul").stop(true).slideUp(b,function(){this.style.display=""})}this.__callback({obj:a})},toggle_node:function(a){a=this._get_node(a);if(a.hasClass("jstree-closed")){return this.open_node(a)}if(a.hasClass("jstree-open")){return this.close_node(a)}},open_all:function(b,c){b=b?this._get_node(b):this.get_container();if(!b||b===-1){b=this.get_container()}if(c){b=b.find("li.jstree-closed")}else{c=b;if(b.is(".jstree-closed")){b=b.find("li.jstree-closed").andSelf()}else{b=b.find("li.jstree-closed")}}var a=this;b.each(function(){var d=this;if(!a._is_loaded(this)){a.open_node(this,function(){a.open_all(d,c)},true)}else{a.open_node(this,false,true)}});if(c.find("li.jstree-closed").length===0){this.__callback({obj:c})}},close_all:function(b){var a=this;b=b?this._get_node(b):this.get_container();if(!b||b===-1){b=this.get_container()}b.find("li.jstree-open").andSelf().each(function(){a.close_node(this)});this.__callback({obj:b})},clean_node:function(a){a=a&&a!=-1?j(a):this.get_container();a=a.is("li")?a.find("li").andSelf():a.find("li");a.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed");a.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:a})},get_rollback:function(){this.__callback();return{i:this.get_index(),h:this.get_container().children("ul").clone(true),d:this.data}},set_rollback:function(b,a){this.get_container().empty().append(b);this.data=a;this.__callback()},load_node:function(a,c,b){this.__callback({obj:a})},_is_loaded:function(a){return true},create_node:function(b,o,c,p,f){b=this._get_node(b);o=typeof o==="undefined"?"last":o;var a=j("<li>"),d=this._get_settings().core,e;if(b!==-1&&!b.length){return false}if(!f&&!this._is_loaded(b)){this.load_node(b,function(){this.create_node(b,o,c,p,true)});return false}this.__rollback();if(typeof c==="string"){c={data:c}}if(!c){c={}}if(c.attr){a.attr(c.attr)}if(c.state){a.addClass("jstree-"+c.state)}if(!c.data){c.data=d.strings.new_node}if(!j.isArray(c.data)){e=c.data;c.data=[];c.data.push(e)}j.each(c.data,function(m,n){e=j("<a>");if(j.isFunction(n)){n=n.call(this,c)}if(typeof n=="string"){e.attr("href","#")[d.html_titles?"html":"text"](n)}else{if(!n.attr){n.attr={}}if(!n.attr.href){n.attr.href="#"}e.attr(n.attr)[d.html_titles?"html":"text"](n.title);if(n.language){e.addClass(n.language)}}e.prepend("<ins class='jstree-icon'>&#160;</ins>");if(n.icon){if(n.icon.indexOf("/")===-1){e.children("ins").addClass(n.icon)}else{e.children("ins").css("background","url('"+n.icon+"') center center no-repeat")}}a.append(e)});a.prepend("<ins class='jstree-icon'>&#160;</ins>");if(b===-1){b=this.get_container();if(o==="before"){o="first"}if(o==="after"){o="last"}}switch(o){case"before":b.before(a);e=this._get_parent(b);break;case"after":b.after(a);e=this._get_parent(b);break;case"inside":case"first":if(!b.children("ul").length){b.append("<ul>")}b.children("ul").prepend(a);e=b;break;case"last":if(!b.children("ul").length){b.append("<ul>")}b.children("ul").append(a);e=b;break;default:if(!b.children("ul").length){b.append("<ul>")}if(!o){o=0}e=b.children("ul").children("li").eq(o);if(e.length){e.before(a)}else{b.children("ul").append(a)}e=b;break}if(e===-1||e.get(0)===this.get_container().get(0)){e=-1}this.clean_node(e);this.__callback({obj:a,parent:e});if(p){p.call(this,a)}return a},get_text:function(a){a=this._get_node(a);if(!a.length){return false}var b=this._get_settings().core.html_titles;a=a.children("a:eq(0)");if(b){a=a.clone();a.children("INS").remove();return a.html()}else{a=a.contents().filter(function(){return this.nodeType==3})[0];return a.nodeValue}},set_text:function(b,a){b=this._get_node(b);if(!b.length){return false}b=b.children("a:eq(0)");if(this._get_settings().core.html_titles){var c=b.children("INS").clone();b.html(a).prepend(c);this.__callback({obj:b,name:a});return true}else{b=b.contents().filter(function(){return this.nodeType==3})[0];this.__callback({obj:b,name:a});return(b.nodeValue=a)}},rename_node:function(b,a){b=this._get_node(b);this.__rollback();if(b&&b.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments))){this.__callback({obj:b,name:a})}},delete_node:function(a){a=this._get_node(a);if(!a.length){return false}this.__rollback();var b=this._get_parent(a),c=this._get_prev(a);a=a.remove();if(b!==-1&&b.find("> ul > li").length===0){b.removeClass("jstree-open jstree-closed").addClass("jstree-leaf")}this.clean_node(b);this.__callback({obj:a,prev:c});return a},prepare_move:function(b,d,a,f,e){var c={};c.ot=j.jstree._reference(c.o)||this;c.o=c.ot._get_node(b);c.r=d===-1?-1:this._get_node(d);c.p=(typeof c==="undefined")?"last":a;if(!e&&h.o&&h.o[0]===c.o[0]&&h.r[0]===c.r[0]&&h.p===c.p){this.__callback(h);if(f){f.call(this,h)}return}c.ot=j.jstree._reference(c.o)||this;c.rt=d===-1?c.ot:j.jstree._reference(c.r)||this;if(c.r===-1){c.cr=-1;switch(c.p){case"first":case"before":case"inside":c.cp=0;break;case"after":case"last":c.cp=c.rt.get_container().find(" > ul > li").length;break;default:c.cp=c.p;break}}else{if(!/^(before|after)$/.test(c.p)&&!this._is_loaded(c.r)){return this.load_node(c.r,function(){this.prepare_move(b,d,a,f,true)})}switch(c.p){case"before":c.cp=c.r.index();c.cr=c.rt._get_parent(c.r);break;case"after":c.cp=c.r.index()+1;c.cr=c.rt._get_parent(c.r);break;case"inside":case"first":c.cp=0;c.cr=c.r;break;case"last":c.cp=c.r.find(" > ul > li").length;c.cr=c.r;break;default:c.cp=c.p;c.cr=c.r;break}}c.np=c.cr==-1?c.rt.get_container():c.cr;c.op=c.ot._get_parent(c.o);c.or=c.np.find(" > ul > li:nth-child("+(c.cp+1)+")");h=c;this.__callback(h);if(f){f.call(this,h)}},check_move:function(){var a=h,b=true;if(a.or[0]===a.o[0]){return false}a.o.each(function(){if(a.r.parentsUntil(".jstree").andSelf().filter("li").index(this)!==-1){b=false;return false}});return b},move_node:function(a,d,o,e,f,b){if(!f){return this.prepare_move(a,d,o,function(m){this.move_node(m,false,false,e,true,b)})}if(!b&&!this.check_move()){return false}this.__rollback();var p=false;if(e){p=a.o.clone();p.find("*[id]").andSelf().each(function(){if(this.id){this.id="copy_"+this.id}})}else{p=a.o}if(a.or.length){a.or.before(p)}else{if(!a.np.children("ul").length){j("<ul>").appendTo(a.np)}a.np.children("ul:eq(0)").append(p)}try{a.ot.clean_node(a.op);a.rt.clean_node(a.np);if(!a.op.find("> ul > li").length){a.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}}catch(c){}if(e){h.cy=true;h.oc=p}this.__callback(h);return h},_get_move:function(){return h}}})})(jQuery);(function(b){b.jstree.plugin("ui",{__init:function(){this.data.ui.selected=b();this.data.ui.last_selected=false;this.data.ui.hovered=null;this.data.ui.to_select=this.get_settings().ui.initially_select;this.get_container().delegate("a","click.jstree",b.proxy(function(a){a.preventDefault();this.select_node(a.currentTarget,true,a)},this)).delegate("a","mouseenter.jstree",b.proxy(function(a){this.hover_node(a.target)},this)).delegate("a","mouseleave.jstree",b.proxy(function(a){this.dehover_node(a.target)},this)).bind("reopen.jstree",b.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",b.proxy(function(){this.dehover_node();this.save_selected()},this)).bind("set_rollback.jstree",b.proxy(function(){this.reselect()},this)).bind("close_node.jstree",b.proxy(function(l,k){var a=this._get_settings().ui,j=this._get_node(k.rslt.obj),i=(j&&j.length)?j.children("ul").find(".jstree-clicked"):b(),h=this;if(a.selected_parent_close===false||!i.length){return}i.each(function(){h.deselect_node(this);if(a.selected_parent_close==="select_parent"){h.select_node(j)}})},this)).bind("delete_node.jstree",b.proxy(function(l,k){var a=this._get_settings().ui.select_prev_on_delete,j=this._get_node(k.rslt.obj),i=(j&&j.length)?j.find(".jstree-clicked"):[],h=this;i.each(function(){h.deselect_node(this)});if(a&&i.length){this.select_node(k.rslt.prev)}},this)).bind("move_node.jstree",b.proxy(function(a,d){if(d.rslt.cy){d.rslt.oc.find(".jstree-clicked").removeClass("jstree-clicked")}},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",selected_parent_close:"select_parent",select_prev_on_delete:true,disable_selecting_children:false,initially_select:[]},_fn:{_get_node:function(a,f){if(typeof a==="undefined"||a===null){return f?this.data.ui.selected:this.data.ui.last_selected}var e=b(a,this.get_container());if(e.is(".jstree")||a==-1){return -1}e=e.closest("li",this.get_container());return e.length?e:false},save_selected:function(){var a=this;this.data.ui.to_select=[];this.data.ui.selected.each(function(){a.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/"))});this.__callback(this.data.ui.to_select)},reselect:function(){var d=this,a=this.data.ui.to_select;a=b.map(b.makeArray(a),function(c){return"#"+c.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/")});this.deselect_all();b.each(a,function(f,c){if(c&&c!=="#"){d.select_node(c)}});this.__callback()},refresh:function(a){this.save_selected();return this.__call_old()},hover_node:function(a){a=this._get_node(a);if(!a.length){return false}if(!a.hasClass("jstree-hovered")){this.dehover_node()}this.data.ui.hovered=a.children("a").addClass("jstree-hovered").parent();this.__callback({obj:a})},dehover_node:function(){var d=this.data.ui.hovered,a;if(!d||!d.length){return false}a=d.children("a").removeClass("jstree-hovered").parent();if(this.data.ui.hovered[0]===a[0]){this.data.ui.hovered=null}this.__callback({obj:d})},select_node:function(j,a,k){j=this._get_node(j);if(j==-1||!j||!j.length){return false}var m=this._get_settings().ui,n=(m.select_multiple_modifier=="on"||(m.select_multiple_modifier!==false&&k&&k[m.select_multiple_modifier+"Key"])),e=this.is_selected(j),l=true;if(a){if(m.disable_selecting_children&&n&&j.parents("li",this.get_container()).children(".jstree-clicked").length){return false}l=false;switch(!0){case (e&&!n):this.deselect_all();e=false;l=true;break;case (!e&&!n):if(m.select_limit==-1||m.select_limit>0){this.deselect_all();l=true}break;case (e&&n):this.deselect_node(j);break;case (!e&&n):if(m.select_limit==-1||this.data.ui.selected.length+1<=m.select_limit){l=true}break}}if(l&&!e){j.children("a").addClass("jstree-clicked");this.data.ui.selected=this.data.ui.selected.add(j);this.data.ui.last_selected=j;this.__callback({obj:j})}},deselect_node:function(a){a=this._get_node(a);if(!a.length){return false}if(this.is_selected(a)){a.children("a").removeClass("jstree-clicked");this.data.ui.selected=this.data.ui.selected.not(a);if(this.data.ui.last_selected.get(0)===a.get(0)){this.data.ui.last_selected=this.data.ui.selected.eq(0)}this.__callback({obj:a})}},toggle_select:function(a){a=this._get_node(a);if(!a.length){return false}if(this.is_selected(a)){this.deselect_node(a)}else{this.select_node(a)}},is_selected:function(a){return this.data.ui.selected.index(this._get_node(a))>=0},get_selected:function(a){return a?b(a).find(".jstree-clicked").parent():this.data.ui.selected},deselect_all:function(a){if(a){b(a).find(".jstree-clicked").removeClass("jstree-clicked")}else{this.get_container().find(".jstree-clicked").removeClass("jstree-clicked")}this.data.ui.selected=b([]);this.data.ui.last_selected=false;this.__callback()}}});b.jstree.defaults.plugins.push("ui")})(jQuery);(function(b){b.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",b.proxy(function(e,f){if(this._get_settings().crrm.move.open_onmove){var a=this;f.rslt.np.parentsUntil(".jstree").andSelf().filter(".jstree-closed").each(function(){a.open_node(this,false,true)})}},this))},defaults:{input_width_limit:200,move:{always_copy:false,open_onmove:true,default_position:"last",check_move:function(a){return true}}},_fn:{_show_input:function(r,k){r=this._get_node(r);var m=this._get_settings().core.rtl,l=this._get_settings().crrm.input_width_limit,p=r.children("ins").width(),q=r.find("> a:visible > ins").width()*r.find("> a:visible > ins").length,a=this.get_text(r),n=b("<div>",{css:{position:"absolute",top:"-200px",left:(m?"0px":"-1000px"),visibility:"hidden"}}).appendTo("body"),o=r.css("position","relative").append(b("<input>",{value:a,css:{padding:"0",border:"1px solid silver",position:"absolute",left:(m?"auto":(p+q+4)+"px"),right:(m?(p+q+4)+"px":"auto"),top:"0px",height:(this.data.core.li_height-2)+"px",lineHeight:(this.data.core.li_height-2)+"px",width:"150px"},blur:b.proxy(function(){var c=r.children("input"),d=c.val();if(d===""){d=a}c.remove();this.set_text(r,a);this.rename_node(r,d);k.call(this,r,d,a);r.css("position","")},this),keyup:function(c){var d=c.keyCode||c.which;if(d==27){this.value=a;this.blur();return}else{if(d==13){this.blur();return}else{o.width(Math.min(n.text("pW"+this.value).width(),l))}}}})).children("input");this.set_text(r,"");n.css({fontFamily:o.css("fontFamily")||"",fontSize:o.css("fontSize")||"",fontWeight:o.css("fontWeight")||"",fontStyle:o.css("fontStyle")||"",fontStretch:o.css("fontStretch")||"",fontVariant:o.css("fontVariant")||"",letterSpacing:o.css("letterSpacing")||"",wordSpacing:o.css("wordSpacing")||""});o.width(Math.min(n.text("pW"+o[0].value).width(),l))[0].select()},rename:function(d){d=this._get_node(d);this.__rollback();var a=this.__callback;this._show_input(d,function(c,g,h){a.call(this,{obj:c,new_name:g,old_name:h})})},create:function(k,n,l,i,a){var m,j=this;k=this._get_node(k);if(!k){k=-1}this.__rollback();m=this.create_node(k,n,l,function(e){var d=this._get_parent(e),c=b(e).index();if(i){i.call(this,e)}if(d.length&&d.hasClass("jstree-closed")){this.open_node(d,false,true)}if(!a){this._show_input(e,function(h,f,g){j.__callback({obj:h,name:f,parent:d,position:c})})}else{j.__callback({obj:e,name:this.get_text(e),parent:d,position:c})}});return m},remove:function(a){a=this._get_node(a,true);this.__rollback();this.delete_node(a);this.__callback({obj:a})},check_move:function(){if(!this.__call_old()){return false}var a=this._get_settings().crrm.move;if(!a.check_move.call(this,this._get_move())){return false}return true},move_node:function(i,k,a,m,n,j){var l=this._get_settings().crrm.move;if(!n){if(!a){a=l.default_position}if(a==="inside"&&!l.default_position.match(/^(before|after)$/)){a=l.default_position}return this.__call_old(true,i,k,a,m,false,j)}if(l.always_copy===true||(l.always_copy==="multitree"&&i.rt.get_index()!==i.ot.get_index())){m=true}this.__call_old(true,i,k,a,m,true,j)},cut:function(a){a=this._get_node(a);this.data.crrm.cp_nodes=false;this.data.crrm.ct_nodes=false;if(!a||!a.length){return false}this.data.crrm.ct_nodes=a},copy:function(a){a=this._get_node(a);this.data.crrm.cp_nodes=false;this.data.crrm.ct_nodes=false;if(!a||!a.length){return false}this.data.crrm.cp_nodes=a},paste:function(a){a=this._get_node(a);if(!a||!a.length){return false}if(!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes){return false}if(this.data.crrm.ct_nodes){this.move_node(this.data.crrm.ct_nodes,a)}if(this.data.crrm.cp_nodes){this.move_node(this.data.crrm.cp_nodes,a,false,true)}this.data.crrm.cp_nodes=false;this.data.crrm.ct_nodes=false}}});b.jstree.defaults.plugins.push("crrm")})(jQuery);(function(d){var c=[];d.jstree._themes=false;d.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",d.proxy(function(){var a=this._get_settings().themes;this.data.themes.dots=a.dots;this.data.themes.icons=a.icons;this.set_theme(a.theme,a.url)},this)).bind("loaded.jstree",d.proxy(function(){if(!this.data.themes.dots){this.hide_dots()}else{this.show_dots()}if(!this.data.themes.icons){this.hide_icons()}else{this.show_icons()}},this))},defaults:{theme:"default",url:false,dots:true,icons:true},_fn:{set_theme:function(a,b){if(!a){return false}if(!b){b=d.jstree._themes+a+"/style.css"}if(d.inArray(b,c)==-1){d.vakata.css.add_sheet({url:b,rel:"jstree"});c.push(b)}if(this.data.themes.theme!=a){this.get_container().removeClass("jstree-"+this.data.themes.theme);this.data.themes.theme=a}this.get_container().addClass("jstree-"+a);if(!this.data.themes.dots){this.hide_dots()}else{this.show_dots()}if(!this.data.themes.icons){this.hide_icons()}else{this.show_icons()}this.__callback()},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=true;this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=false;this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){if(this.data.themes.dots){this.hide_dots()}else{this.show_dots()}},show_icons:function(){this.data.themes.icons=true;this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=false;this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){if(this.data.themes.icons){this.hide_icons()}else{this.show_icons()}}}});d(function(){if(d.jstree._themes===false){d("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/)){d.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/";return false}})}if(d.jstree._themes===false){d.jstree._themes="themes/"}});d.jstree.defaults.plugins.push("themes")})(jQuery);(function(f){var d=[];function e(c,b){var a=f.jstree._focused(),i;if(a&&a.data&&a.data.hotkeys&&a.data.hotkeys.enabled){i=a._get_settings().hotkeys[c];if(i){return i.call(a,b)}}}f.jstree.plugin("hotkeys",{__init:function(){if(typeof f.hotkeys==="undefined"){throw"jsTree hotkeys: jQuery hotkeys plugin not included."}if(!this.data.ui){throw"jsTree hotkeys: jsTree UI plugin not included."}f.each(this._get_settings().hotkeys,function(b,a){if(f.inArray(b,d)==-1){f(document).bind("keydown",b,function(c){return e(b,c)});d.push(b)}});this.enable_hotkeys()},defaults:{up:function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_prev(a));return false},down:function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_next(a));return false},left:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;if(a){if(a.hasClass("jstree-open")){this.close_node(a)}else{this.hover_node(this._get_prev(a))}}return false},right:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;if(a&&a.length){if(a.hasClass("jstree-closed")){this.open_node(a)}else{this.hover_node(this._get_next(a))}}return false},space:function(){if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").click()}return false},"ctrl+space":function(a){a.type="click";if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").trigger(a)}return false},f2:function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected)},del:function(){this.remove(this.data.ui.hovered||this._get_node(null))}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=true},disable_hotkeys:function(){this.data.hotkeys.enabled=false}}})})(jQuery);(function(b){b.jstree.plugin("json_data",{defaults:{data:false,ajax:false,correct_state:true,progressive_render:false},_fn:{load_node:function(g,a,h){var f=this;this.load_node_json(g,function(){f.__callback({obj:g});a.call(this)},h)},_is_loaded:function(f){var a=this._get_settings().json_data,d;f=this._get_node(f);if(f&&f!==-1&&a.progressive_render&&!f.is(".jstree-open, .jstree-leaf")&&f.children("ul").children("li").length===0&&f.data("jstree-children")){d=this._parse_json(f.data("jstree-children"));if(d){f.append(d);b.removeData(f,"jstree-children")}this.clean_node(f);return true}return f==-1||!f||!a.ajax||f.is(".jstree-open, .jstree-leaf")||f.children("ul").children("li").size()>0},load_node_json:function(k,a,m){var l=this.get_settings().json_data,d,n=function(){},j=function(){};k=this._get_node(k);if(k&&k!==-1){if(k.data("jstree-is-loading")){return}else{k.data("jstree-is-loading",true)}}switch(!0){case (!l.data&&!l.ajax):throw"Neither data nor ajax settings supplied.";case (!!l.data&&!l.ajax)||(!!l.data&&!!l.ajax&&(!k||k===-1)):if(!k||k==-1){d=this._parse_json(l.data);if(d){this.get_container().children("ul").empty().append(d.children());this.clean_node()}else{if(l.correct_state){this.get_container().children("ul").empty()}}}if(a){a.call(this)}break;case (!l.data&&!!l.ajax)||(!!l.data&&!!l.ajax&&k&&k!==-1):n=function(f,e,c){var g=this.get_settings().json_data.ajax.error;if(g){g.call(this,f,e,c)}if(k!=-1&&k.length){k.children(".jstree-loading").removeClass("jstree-loading");k.data("jstree-is-loading",false);if(e==="success"&&l.correct_state){k.removeClass("jstree-open jstree-closed").addClass("jstree-leaf")}}else{if(e==="success"&&l.correct_state){this.get_container().children("ul").empty()}}if(m){m.call(this)}};j=function(c,f,g){var e=this.get_settings().json_data.ajax.success;if(e){c=e.call(this,c,f,g)||c}if(c===""||(!b.isArray(c)&&!b.isPlainObject(c))){return n.call(this,g,f,"")}c=this._parse_json(c);if(c){if(k===-1||!k){this.get_container().children("ul").empty().append(c.children())}else{k.append(c).children(".jstree-loading").removeClass("jstree-loading");k.data("jstree-is-loading",false)}this.clean_node(k);if(a){a.call(this)}}else{if(k===-1||!k){if(l.correct_state){this.get_container().children("ul").empty();if(a){a.call(this)}}}else{k.children(".jstree-loading").removeClass("jstree-loading");k.data("jstree-is-loading",false);if(l.correct_state){k.removeClass("jstree-open jstree-closed").addClass("jstree-leaf");if(a){a.call(this)}}}}};l.ajax.context=this;l.ajax.error=n;l.ajax.success=j;if(!l.ajax.dataType){l.ajax.dataType="json"}if(b.isFunction(l.ajax.url)){l.ajax.url=l.ajax.url.call(this,k)}if(b.isFunction(l.ajax.data)){l.ajax.data=l.ajax.data.call(this,k)}b.ajax(l.ajax);break}},_parse_json:function(v,i){var q=false,u=this._get_settings(),a=u.json_data,d=u.core.html_titles,s,r,t,j,p;if(!v){return q}if(b.isFunction(v)){v=v.call(this)}if(b.isArray(v)){q=b();if(!v.length){return false}for(r=0,t=v.length;r<t;r++){s=this._parse_json(v[r],true);if(s.length){q=q.add(s)}}}else{if(typeof v=="string"){v={data:v}}if(!v.data&&v.data!==""){return q}q=b("<li>");if(v.attr){q.attr(v.attr)}if(v.metadata){q.data("jstree",v.metadata)}if(v.state){q.addClass("jstree-"+v.state)}if(!b.isArray(v.data)){s=v.data;v.data=[];v.data.push(s)}b.each(v.data,function(c,e){s=b("<a>");if(b.isFunction(e)){e=e.call(this,v)}if(typeof e=="string"){s.attr("href","#")[d?"html":"text"](e)}else{if(!e.attr){e.attr={}}if(!e.attr.href){e.attr.href="#"}s.attr(e.attr)[d?"html":"text"](e.title);if(e.language){s.addClass(e.language)}}s.prepend("<ins class='jstree-icon'>&#160;</ins>");if(!e.icon&&v.icon){e.icon=v.icon}if(e.icon){if(e.icon.indexOf("/")===-1){s.children("ins").addClass(e.icon)}else{s.children("ins").css("background","url('"+e.icon+"') center center no-repeat")}}q.append(s)});q.prepend("<ins class='jstree-icon'>&#160;</ins>");if(v.children){if(a.progressive_render&&v.state!=="open"){q.addClass("jstree-closed").data("jstree-children",v.children)}else{if(b.isFunction(v.children)){v.children=v.children.call(this,v)}if(b.isArray(v.children)&&v.children.length){s=this._parse_json(v.children,true);if(s.length){p=b("<ul>");p.append(s);q.append(p)}}}}}if(!i){j=b("<ul>");j.append(q);q=j}return q},get_json:function(u,x,z,q){var a=[],o=this._get_settings(),t=this,v,w,r,s,p,y;u=this._get_node(u);if(!u||u===-1){u=this.get_container().find("> ul > li")}x=b.isArray(x)?x:["id","class"];if(!q&&this.data.types){x.push(o.types.type_attr)}z=b.isArray(z)?z:[];u.each(function(){r=b(this);v={data:[]};if(x.length){v.attr={}}b.each(x,function(c,d){w=r.attr(d);if(w&&w.length&&w.replace(/jstree[^ ]*|$/ig,"").length){v.attr[d]=w.replace(/jstree[^ ]*|$/ig,"")}});if(r.hasClass("jstree-open")){v.state="open"}if(r.hasClass("jstree-closed")){v.state="closed"}s=r.children("a");s.each(function(){p=b(this);if(z.length||b.inArray("languages",o.plugins)!==-1||p.children("ins").get(0).style.backgroundImage.length||(p.children("ins").get(0).className&&p.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").length)){y=false;if(b.inArray("languages",o.plugins)!==-1&&b.isArray(o.languages)&&o.languages.length){b.each(o.languages,function(d,c){if(p.hasClass(c)){y=c;return false}})}w={attr:{},title:t.get_text(p,y)};b.each(z,function(d,c){v.attr[c]=(p.attr(c)||"").replace(/jstree[^ ]*|$/ig,"")});b.each(o.languages,function(d,c){if(p.hasClass(c)){w.language=c;return true}});if(p.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length){w.icon=p.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"")}if(p.children("ins").get(0).style.backgroundImage.length){w.icon=p.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","")}}else{w=t.get_text(p)}if(s.length>1){v.data.push(w)}else{v.data=w}});r=r.find("> ul > li");if(r.length){v.children=t.get_json(r,x,z,true)}a.push(v)});return a}}})})(jQuery);(function(b){b.jstree.plugin("languages",{__init:function(){this._load_css()},defaults:[],_fn:{set_lang:function(g){var f=this._get_settings().languages,h=false,a=".jstree-"+this.get_index()+" a";if(!b.isArray(f)||f.length===0){return false}if(b.inArray(g,f)==-1){if(!!f[g]){g=f[g]}else{return false}}if(g==this.data.languages.current_language){return true}h=b.vakata.css.get_css(a+"."+this.data.languages.current_language,false,this.data.languages.language_css);if(h!==false){h.style.display="none"}h=b.vakata.css.get_css(a+"."+g,false,this.data.languages.language_css);if(h!==false){h.style.display=""}this.data.languages.current_language=g;this.__callback(g);return true},get_lang:function(){return this.data.languages.current_language},get_text:function(g,f){g=this._get_node(g)||this.data.ui.last_selected;if(!g.size()){return false}var h=this._get_settings().languages,a=this._get_settings().core.html_titles;if(b.isArray(h)&&h.length){f=(f&&b.inArray(f,h)!=-1)?f:this.data.languages.current_language;g=g.children("a."+f)}else{g=g.children("a:eq(0)")}if(a){g=g.clone();g.children("INS").remove();return g.html()}else{g=g.contents().filter(function(){return this.nodeType==3})[0];return g.nodeValue}},set_text:function(j,h,i){j=this._get_node(j)||this.data.ui.last_selected;if(!j.size()){return false}var k=this._get_settings().languages,l=this._get_settings().core.html_titles,a;if(b.isArray(k)&&k.length){i=(i&&b.inArray(i,k)!=-1)?i:this.data.languages.current_language;j=j.children("a."+i)}else{j=j.children("a:eq(0)")}if(l){a=j.children("INS").clone();j.html(h).prepend(a);this.__callback({obj:j,name:h,lang:i});return true}else{j=j.contents().filter(function(){return this.nodeType==3})[0];this.__callback({obj:j,name:h,lang:i});return(j.nodeValue=h)}},_load_css:function(){var g=this._get_settings().languages,f="/* languages css */",a=".jstree-"+this.get_index()+" a",h;if(b.isArray(g)&&g.length){this.data.languages.current_language=g[0];for(h=0;h<g.length;h++){f+=a+"."+g[h]+" {";if(g[h]!=this.data.languages.current_language){f+=" display:none; "}f+=" } "}this.data.languages.language_css=b.vakata.css.add_sheet({str:f})}},create_node:function(h,a,i,g){var j=this.__call_old(true,h,a,i,function(e){var c=this._get_settings().languages,f=e.children("a"),d;if(b.isArray(c)&&c.length){for(d=0;d<c.length;d++){if(!f.is("."+c[d])){e.append(f.eq(0).clone().removeClass(c.join(" ")).addClass(c[d]))}}f.not("."+c.join(", .")).remove()}if(g){g.call(this,e)}});return j}}})})(jQuery);(function(b){b.jstree.plugin("cookies",{__init:function(){if(typeof b.cookie==="undefined"){throw"jsTree cookie: jQuery cookie plugin not included."}var d=this._get_settings().cookies,a;if(!!d.save_opened){a=b.cookie(d.save_opened);if(a&&a.length){this.data.core.to_open=a.split(",")}}if(!!d.save_selected){a=b.cookie(d.save_selected);if(a&&a.length&&this.data.ui){this.data.ui.to_select=a.split(",")}}this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",b.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",b.proxy(function(c){if(this._get_settings().cookies.auto_save){this.save_cookie((c.handleObj.namespace+c.handleObj.type).replace("jstree",""))}},this))},this))},defaults:{save_opened:"jstree_open",save_selected:"jstree_select",auto_save:true,cookie_options:{}},_fn:{save_cookie:function(c){if(this.data.core.refreshing){return}var a=this._get_settings().cookies;if(!c){if(a.save_opened){this.save_opened();b.cookie(a.save_opened,this.data.core.to_open.join(","),a.cookie_options)}if(a.save_selected&&this.data.ui){this.save_selected();b.cookie(a.save_selected,this.data.ui.to_select.join(","),a.cookie_options)}return}switch(c){case"open_node":case"close_node":if(!!a.save_opened){this.save_opened();b.cookie(a.save_opened,this.data.core.to_open.join(","),a.cookie_options)}break;case"select_node":case"deselect_node":if(!!a.save_selected&&this.data.ui){this.save_selected();b.cookie(a.save_selected,this.data.ui.to_select.join(","),a.cookie_options)}break}}}});b.jstree.defaults.plugins.push("cookies")})(jQuery);(function(b){b.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",b.proxy(function(e,a){var f=this._get_node(a.rslt.obj);f=f===-1?this.get_container().children("ul"):f.children("ul");this.sort(f)},this)).bind("rename_node.jstree",b.proxy(function(d,a){this.sort(a.rslt.obj.parent())},this)).bind("move_node.jstree",b.proxy(function(e,f){var a=f.rslt.np==-1?this.get_container():f.rslt.np;this.sort(a.children("ul"))},this))},defaults:function(a,e){return this.get_text(a)>this.get_text(e)?1:-1},_fn:{sort:function(e){var f=this._get_settings().sort,a=this;e.append(b.makeArray(e.children("li")).sort(b.proxy(f,a)));e.find("> li > ul").each(function(){a.sort(b(this))});this.clean_node(e)}}})})(jQuery);(function(m){var k=false,p=false,j=false,i=false,n=false,l=false,o=false;m.vakata.dnd={is_down:false,is_drag:false,helper:false,scroll_spd:10,init_x:0,init_y:0,threshold:5,user_data:{},drag_start:function(a,b,d){if(m.vakata.dnd.is_drag){m.vakata.drag_stop({})}try{a.currentTarget.unselectable="on";a.currentTarget.onselectstart=function(){return false};if(a.currentTarget.style){a.currentTarget.style.MozUserSelect="none"}}catch(c){}m.vakata.dnd.init_x=a.pageX;m.vakata.dnd.init_y=a.pageY;m.vakata.dnd.user_data=b;m.vakata.dnd.is_down=true;m.vakata.dnd.helper=m("<div id='vakata-dragged'>").html(d).css("opacity","0.75");m(document).bind("mousemove",m.vakata.dnd.drag);m(document).bind("mouseup",m.vakata.dnd.drag_stop);return false},drag:function(b){if(!m.vakata.dnd.is_down){return}if(!m.vakata.dnd.is_drag){if(Math.abs(b.pageX-m.vakata.dnd.init_x)>5||Math.abs(b.pageY-m.vakata.dnd.init_y)>5){m.vakata.dnd.helper.appendTo("body");m.vakata.dnd.is_drag=true;m(document).triggerHandler("drag_start.vakata",{event:b,data:m.vakata.dnd.user_data})}else{return}}if(b.type==="mousemove"){var a=m(document),c=a.scrollTop(),d=a.scrollLeft();if(b.pageY-c<20){if(n&&l==="down"){clearInterval(n);n=false}if(!n){l="up";n=setInterval(function(){m(document).scrollTop(m(document).scrollTop()-m.vakata.dnd.scroll_spd)},150)}}else{if(n&&l==="up"){clearInterval(n);n=false}}if(m(window).height()-(b.pageY-c)<20){if(n&&l==="up"){clearInterval(n);n=false}if(!n){l="down";n=setInterval(function(){m(document).scrollTop(m(document).scrollTop()+m.vakata.dnd.scroll_spd)},150)}}else{if(n&&l==="down"){clearInterval(n);n=false}}if(b.pageX-d<20){if(i&&o==="right"){clearInterval(i);i=false}if(!i){o="left";i=setInterval(function(){m(document).scrollLeft(m(document).scrollLeft()-m.vakata.dnd.scroll_spd)},150)}}else{if(i&&o==="left"){clearInterval(i);i=false}}if(m(window).width()-(b.pageX-d)<20){if(i&&o==="left"){clearInterval(i);i=false}if(!i){o="right";i=setInterval(function(){m(document).scrollLeft(m(document).scrollLeft()+m.vakata.dnd.scroll_spd)},150)}}else{if(i&&o==="right"){clearInterval(i);i=false}}}m.vakata.dnd.helper.css({left:(b.pageX+5)+"px",top:(b.pageY+10)+"px"});m(document).triggerHandler("drag.vakata",{event:b,data:m.vakata.dnd.user_data})},drag_stop:function(a){m(document).unbind("mousemove",m.vakata.dnd.drag);m(document).unbind("mouseup",m.vakata.dnd.drag_stop);m(document).triggerHandler("drag_stop.vakata",{event:a,data:m.vakata.dnd.user_data});m.vakata.dnd.helper.remove();m.vakata.dnd.init_x=0;m.vakata.dnd.init_y=0;m.vakata.dnd.user_data={};m.vakata.dnd.is_down=false;m.vakata.dnd.is_drag=false}};m(function(){var a="#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ";m.vakata.css.add_sheet({str:a})});m.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:false,after:false,inside:false,before:false,off:false,prepared:false,w:0,to1:false,to2:false,cof:false,cw:false,ch:false,i1:false,i2:false};this.get_container().bind("mouseenter.jstree",m.proxy(function(){if(m.vakata.dnd.is_drag&&m.vakata.dnd.user_data.jstree&&this.data.themes){j.attr("class","jstree-"+this.data.themes.theme);m.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)}},this)).bind("mouseleave.jstree",m.proxy(function(){if(m.vakata.dnd.is_drag&&m.vakata.dnd.user_data.jstree){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}}},this)).bind("mousemove.jstree",m.proxy(function(b){if(m.vakata.dnd.is_drag&&m.vakata.dnd.user_data.jstree){var c=this.get_container()[0];if(b.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}this.data.dnd.i1=setInterval(m.proxy(function(){this.scrollLeft+=m.vakata.dnd.scroll_spd},c),100)}else{if(b.pageX-24<this.data.dnd.cof.left){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}this.data.dnd.i1=setInterval(m.proxy(function(){this.scrollLeft-=m.vakata.dnd.scroll_spd},c),100)}else{if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}}}if(b.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch){if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}this.data.dnd.i2=setInterval(m.proxy(function(){this.scrollTop+=m.vakata.dnd.scroll_spd},c),100)}else{if(b.pageY-24<this.data.dnd.cof.top){if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}this.data.dnd.i2=setInterval(m.proxy(function(){this.scrollTop-=m.vakata.dnd.scroll_spd},c),100)}else{if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}}}}},this)).delegate("a","mousedown.jstree",m.proxy(function(b){if(b.which===1){this.start_drag(b.currentTarget,b);return false}},this)).delegate("a","mouseenter.jstree",m.proxy(function(b){if(m.vakata.dnd.is_drag&&m.vakata.dnd.user_data.jstree){this.dnd_enter(b.currentTarget)}},this)).delegate("a","mousemove.jstree",m.proxy(function(b){if(m.vakata.dnd.is_drag&&m.vakata.dnd.user_data.jstree){if(typeof this.data.dnd.off.top==="undefined"){this.data.dnd.off=m(b.target).offset()}this.data.dnd.w=(b.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height;if(this.data.dnd.w<0){this.data.dnd.w+=this.data.core.li_height}this.dnd_show()}},this)).delegate("a","mouseleave.jstree",m.proxy(function(b){if(m.vakata.dnd.is_drag&&m.vakata.dnd.user_data.jstree){this.data.dnd.after=false;this.data.dnd.before=false;this.data.dnd.inside=false;m.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");j.hide();if(p&&p[0]===b.target.parentNode){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1);this.data.dnd.to1=false}if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2);this.data.dnd.to2=false}}}},this)).delegate("a","mouseup.jstree",m.proxy(function(b){if(m.vakata.dnd.is_drag&&m.vakata.dnd.user_data.jstree){this.dnd_finish(b)}},this));m(document).bind("drag_stop.vakata",m.proxy(function(){this.data.dnd.after=false;this.data.dnd.before=false;this.data.dnd.inside=false;this.data.dnd.off=false;this.data.dnd.prepared=false;this.data.dnd.w=false;this.data.dnd.to1=false;this.data.dnd.to2=false;this.data.dnd.active=false;this.data.dnd.foreign=false;if(j){j.css({top:"-2000px"})}},this)).bind("drag_start.vakata",m.proxy(function(b,d){if(d.data.jstree){var c=m(d.event.target);if(c.closest(".jstree").hasClass("jstree-"+this.get_index())){this.dnd_enter(c)}}},this));var a=this._get_settings().dnd;if(a.drag_target){m(document).delegate(a.drag_target,"mousedown.jstree",m.proxy(function(b){k=b.target;m.vakata.dnd.drag_start(b,{jstree:true,obj:b.target},"<ins class='jstree-icon'></ins>"+m(b.target).text());if(this.data.themes){j.attr("class","jstree-"+this.data.themes.theme);m.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)}m.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");var c=this.get_container();this.data.dnd.cof=c.offset();this.data.dnd.cw=parseInt(c.width(),10);this.data.dnd.ch=parseInt(c.height(),10);this.data.dnd.foreign=true;return false},this))}if(a.drop_target){m(document).delegate(a.drop_target,"mouseenter.jstree",m.proxy(function(b){if(this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{o:k,r:m(b.target)})){m.vakata.dnd.helper.children("ins").attr("class","jstree-ok")}},this)).delegate(a.drop_target,"mouseleave.jstree",m.proxy(function(b){if(this.data.dnd.active){m.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")}},this)).delegate(a.drop_target,"mouseup.jstree",m.proxy(function(b){if(this.data.dnd.active&&m.vakata.dnd.helper.children("ins").hasClass("jstree-ok")){this._get_settings().dnd.drop_finish.call(this,{o:k,r:m(b.target)})}},this))}},defaults:{copy_modifier:"ctrl",check_timeout:200,open_timeout:500,drop_target:".jstree-drop",drop_check:function(a){return true},drop_finish:m.noop,drag_target:".jstree-draggable",drag_finish:m.noop,drag_check:function(a){return{after:false,before:false,inside:true}}},_fn:{dnd_prepare:function(){if(!p||!p.length){return}this.data.dnd.off=p.offset();if(this._get_settings().core.rtl){this.data.dnd.off.right=this.data.dnd.off.left+p.width()}if(this.data.dnd.foreign){var a=this._get_settings().dnd.drag_check.call(this,{o:k,r:p});this.data.dnd.after=a.after;this.data.dnd.before=a.before;this.data.dnd.inside=a.inside;this.data.dnd.prepared=true;return this.dnd_show()}this.prepare_move(k,p,"before");this.data.dnd.before=this.check_move();this.prepare_move(k,p,"after");this.data.dnd.after=this.check_move();if(this._is_loaded(p)){this.prepare_move(k,p,"inside");this.data.dnd.inside=this.check_move()}else{this.data.dnd.inside=false}this.data.dnd.prepared=true;return this.dnd_show()},dnd_show:function(){if(!this.data.dnd.prepared){return}var b=["before","inside","after"],d=false,c=this._get_settings().core.rtl,a;if(this.data.dnd.w<this.data.core.li_height/3){b=["before","inside","after"]}else{if(this.data.dnd.w<=this.data.core.li_height*2/3){b=this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"]}else{b=["after","inside","before"]}}m.each(b,m.proxy(function(e,f){if(this.data.dnd[f]){m.vakata.dnd.helper.children("ins").attr("class","jstree-ok");d=f;return false}},this));if(d===false){m.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")}a=c?(this.data.dnd.off.right-18):(this.data.dnd.off.left+10);switch(d){case"before":j.css({left:a+"px",top:(this.data.dnd.off.top-6)+"px"}).show();break;case"after":j.css({left:a+"px",top:(this.data.dnd.off.top+this.data.core.li_height-7)+"px"}).show();break;case"inside":j.css({left:a+(c?-4:4)+"px",top:(this.data.dnd.off.top+this.data.core.li_height/2-5)+"px"}).show();break;default:j.hide();break}return d},dnd_open:function(){this.data.dnd.to2=false;this.open_node(p,m.proxy(this.dnd_prepare,this),true)},dnd_finish:function(a){if(this.data.dnd.foreign){if(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside){this._get_settings().dnd.drag_finish.call(this,{o:k,r:p})}}else{this.dnd_prepare();this.move_node(k,p,this.dnd_show(),a[this._get_settings().dnd.copy_modifier+"Key"])}k=false;p=false;j.hide()},dnd_enter:function(a){var b=this._get_settings().dnd;this.data.dnd.prepared=false;p=this._get_node(a);if(b.check_timeout){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1)}this.data.dnd.to1=setTimeout(m.proxy(this.dnd_prepare,this),b.check_timeout)}else{this.dnd_prepare()}if(b.open_timeout){if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2)}if(p&&p.length&&p.hasClass("jstree-closed")){this.data.dnd.to2=setTimeout(m.proxy(this.dnd_open,this),b.open_timeout)}}else{if(p&&p.length&&p.hasClass("jstree-closed")){this.dnd_open()}}},start_drag:function(a,b){k=this._get_node(a);if(this.data.ui&&this.is_selected(k)){k=this._get_node(null,true)}m.vakata.dnd.drag_start(b,{jstree:true,obj:k},"<ins class='jstree-icon'></ins>"+(k.length>1?"Multiple selection":this.get_text(k)));if(this.data.themes){j.attr("class","jstree-"+this.data.themes.theme);m.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)}var c=this.get_container();this.data.dnd.cof=c.children("ul").offset();this.data.dnd.cw=parseInt(c.width(),10);this.data.dnd.ch=parseInt(c.height(),10);this.data.dnd.active=true}}});m(function(){var a="#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px; } #vakata-dragged .jstree-ok { background:green; } #vakata-dragged .jstree-invalid { background:red; } #jstree-marker { padding:0; margin:0; line-height:12px; font-size:1px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:silver; } ";m.vakata.css.add_sheet({str:a});j=m("<div>").attr({id:"jstree-marker"}).hide().appendTo("body");m(document).bind("drag_start.vakata",function(b,c){if(c.data.jstree){j.show()}});m(document).bind("drag_stop.vakata",function(b,c){if(c.data.jstree){j.hide()}})})})(jQuery);(function(b){b.jstree.plugin("checkbox",{__init:function(){this.select_node=this.deselect_node=this.deselect_all=b.noop;this.get_selected=this.get_checked;this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree",b.proxy(function(d,a){this._prepare_checkboxes(a.rslt.obj)},this)).bind("loaded.jstree",b.proxy(function(a){this._prepare_checkboxes()},this)).delegate("a","click.jstree",b.proxy(function(a){if(this._get_node(a.target).hasClass("jstree-checked")){this.uncheck_node(a.target)}else{this.check_node(a.target)}if(this.data.ui){this.save_selected()}if(this.data.cookies){this.save_cookie("select_node")}a.preventDefault()},this))},__destroy:function(){this.get_container().find(".jstree-checkbox").remove()},_fn:{_prepare_checkboxes:function(h){h=!h||h==-1?this.get_container():this._get_node(h);var c,g=this,a;h.each(function(){a=b(this);c=a.is("li")&&a.hasClass("jstree-checked")?"jstree-checked":"jstree-unchecked";a.find("a").not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(c)});if(h.is("li")){this._repair_state(h)}else{h.find("> ul > li").each(function(){g._repair_state(this)})}},change_state:function(d,a){d=this._get_node(d);a=(a===false||a===true)?a:d.hasClass("jstree-checked");if(a){d.find("li").andSelf().removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked")}else{d.find("li").andSelf().removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");if(this.data.ui){this.data.ui.last_selected=d}this.data.checkbox.last_selected=d}d.parentsUntil(".jstree","li").each(function(){var c=b(this);if(a){if(c.children("ul").children(".jstree-checked, .jstree-undetermined").length){c.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");return false}else{c.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked")}}else{if(c.children("ul").children(".jstree-unchecked, .jstree-undetermined").length){c.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");return false}else{c.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked")}}});if(this.data.ui){this.data.ui.selected=this.get_checked()}this.__callback(d)},check_node:function(a){this.change_state(a,false)},uncheck_node:function(a){this.change_state(a,true)},check_all:function(){var a=this;this.get_container().children("ul").children("li").each(function(){a.check_node(this,false)})},uncheck_all:function(){var a=this;this.get_container().children("ul").children("li").each(function(){a.change_state(this,true)})},is_checked:function(a){a=this._get_node(a);return a.length?a.is(".jstree-checked"):false},get_checked:function(a){a=!a||a===-1?this.get_container():this._get_node(a);return a.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")},get_unchecked:function(a){a=!a||a===-1?this.get_container():this._get_node(a);return a.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(c){c=this._get_node(c);if(!c.length){return}var h=c.find("> ul > .jstree-checked").length,i=c.find("> ul > .jstree-undetermined").length,a=c.find("> ul > li").length;if(a===0){if(c.hasClass("jstree-undetermined")){this.check_node(c)}}else{if(h===0&&i===0){this.uncheck_node(c)}else{if(h===a){this.check_node(c)}else{c.parentsUntil(".jstree","li").removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined")}}}},reselect:function(){if(this.data.ui){var d=this,a=this.data.ui.to_select;a=b.map(b.makeArray(a),function(c){return"#"+c.toString().replace(/^#/,"").replace("\\/","/").replace("/","\\/")});this.deselect_all();b.each(a,function(f,c){d.check_node(c)});this.__callback()}}}})})(jQuery);(function(c){c.vakata.xslt=function(n,m,a){var p="",b,o,k,l;if(document.recalc){b=document.createElement("xml");o=document.createElement("xml");b.innerHTML=n;o.innerHTML=m;c("body").append(b).append(o);setTimeout((function(f,g,e){return function(){e.call(null,f.transformNode(g.XMLDocument));setTimeout((function(h,i){return function(){jQuery("body").remove(h).remove(i)}})(f,g),200)}})(b,o,a),100);return true}if(typeof window.DOMParser!=="undefined"&&typeof window.XMLHttpRequest!=="undefined"&&typeof window.XSLTProcessor!=="undefined"){k=new XSLTProcessor();l=c.isFunction(k.transformDocument)?(typeof window.XMLSerializer!=="undefined"):true;if(!l){return false}n=new DOMParser().parseFromString(n,"text/xml");m=new DOMParser().parseFromString(m,"text/xml");if(c.isFunction(k.transformDocument)){p=document.implementation.createDocument("","",null);k.transformDocument(n,m,p,null);a.call(null,XMLSerializer().serializeToString(p));return true}else{k.importStylesheet(m);p=k.transformToFragment(n,document);a.call(null,c("<div>").append(p).html());return true}}return false};var d={nest:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">	<xsl:call-template name="nodes">		<xsl:with-param name="node" select="/root" />	</xsl:call-template></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<ul>	<xsl:for-each select="$node/item">		<xsl:variable name="children" select="count(./item) &gt; 0" />		<li>			<xsl:attribute name="class">				<xsl:if test="position() = last()">jstree-last </xsl:if>				<xsl:choose>					<xsl:when test="@state = \'open\'">jstree-open </xsl:when>					<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>					<xsl:otherwise>jstree-leaf </xsl:otherwise>				</xsl:choose>				<xsl:value-of select="@class" />			</xsl:attribute>			<xsl:for-each select="@*">				<xsl:if test="name() != \'class\' and name() != \'state\' and name() != \'hasChildren\'">					<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>				</xsl:if>			</xsl:for-each>	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>			<xsl:for-each select="content/name">				<a>				<xsl:attribute name="href">					<xsl:choose>					<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>					<xsl:otherwise>#</xsl:otherwise>					</xsl:choose>				</xsl:attribute>				<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>				<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>				<xsl:for-each select="@*">					<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">						<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>					</xsl:if>				</xsl:for-each>					<ins>						<xsl:attribute name="class">jstree-icon 							<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>						</xsl:attribute>						<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>						<xsl:text>&#xa0;</xsl:text>					</ins>					<xsl:value-of select="current()" />				</a>			</xsl:for-each>			<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>		</li>	</xsl:for-each>	</ul></xsl:template></xsl:stylesheet>',flat:'<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">	<ul>	<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">		<xsl:call-template name="nodes">			<xsl:with-param name="node" select="." />			<xsl:with-param name="is_last" select="number(position() = last())" />		</xsl:call-template>	</xsl:for-each>	</ul></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<xsl:param name="is_last" />	<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />	<li>	<xsl:attribute name="class">		<xsl:if test="$is_last = true()">jstree-last </xsl:if>		<xsl:choose>			<xsl:when test="@state = \'open\'">jstree-open </xsl:when>			<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>			<xsl:otherwise>jstree-leaf </xsl:otherwise>		</xsl:choose>		<xsl:value-of select="@class" />	</xsl:attribute>	<xsl:for-each select="@*">		<xsl:if test="name() != \'parent_id\' and name() != \'hasChildren\' and name() != \'class\' and name() != \'state\'">		<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>		</xsl:if>	</xsl:for-each>	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>	<xsl:for-each select="content/name">		<a>		<xsl:attribute name="href">			<xsl:choose>			<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>			<xsl:otherwise>#</xsl:otherwise>			</xsl:choose>		</xsl:attribute>		<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>		<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>		<xsl:for-each select="@*">			<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">				<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>			</xsl:if>		</xsl:for-each>			<ins>				<xsl:attribute name="class">jstree-icon 					<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>				</xsl:attribute>				<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>				<xsl:text>&#xa0;</xsl:text>			</ins>			<xsl:value-of select="current()" />		</a>	</xsl:for-each>	<xsl:if test="$children">		<ul>		<xsl:for-each select="//item[@parent_id=$node/attribute::id]">			<xsl:call-template name="nodes">				<xsl:with-param name="node" select="." />				<xsl:with-param name="is_last" select="number(position() = last())" />			</xsl:call-template>		</xsl:for-each>		</ul>	</xsl:if>	</li></xsl:template></xsl:stylesheet>'};c.jstree.plugin("xml_data",{defaults:{data:false,ajax:false,xsl:"flat",clean_node:false,correct_state:true},_fn:{load_node:function(b,h,g){var a=this;this.load_node_xml(b,function(){a.__callback({obj:b});h.call(this)},g)},_is_loaded:function(a){var b=this._get_settings().xml_data;a=this._get_node(a);return a==-1||!a||!b.ajax||a.is(".jstree-open, .jstree-leaf")||a.children("ul").children("li").size()>0},load_node_xml:function(b,l,j){var i=this.get_settings().xml_data,k=function(){},a=function(){};b=this._get_node(b);if(b&&b!==-1){if(b.data("jstree-is-loading")){return}else{b.data("jstree-is-loading",true)}}switch(!0){case (!i.data&&!i.ajax):throw"Neither data nor ajax settings supplied.";case (!!i.data&&!i.ajax)||(!!i.data&&!!i.ajax&&(!b||b===-1)):if(!b||b==-1){this.parse_xml(i.data,c.proxy(function(e){if(e){e=e.replace(/ ?xmlns="[^"]*"/ig,"");if(e.length>10){e=c(e);this.get_container().children("ul").empty().append(e.children());if(i.clean_node){this.clean_node(b)}if(l){l.call(this)}}}else{if(i.correct_state){this.get_container().children("ul").empty();if(l){l.call(this)}}}},this))}break;case (!i.data&&!!i.ajax)||(!!i.data&&!!i.ajax&&b&&b!==-1):k=function(g,f,e){var h=this.get_settings().xml_data.ajax.error;if(h){h.call(this,g,f,e)}if(b!==-1&&b.length){b.children(".jstree-loading").removeClass("jstree-loading");b.data("jstree-is-loading",false);if(f==="success"&&i.correct_state){b.removeClass("jstree-open jstree-closed").addClass("jstree-leaf")}}else{if(f==="success"&&i.correct_state){this.get_container().children("ul").empty()}}if(j){j.call(this)}};a=function(e,g,h){e=h.responseText;var f=this.get_settings().xml_data.ajax.success;if(f){e=f.call(this,e,g,h)||e}if(e==""){return k.call(this,h,g,"")}this.parse_xml(e,c.proxy(function(n){if(n){n=n.replace(/ ?xmlns="[^"]*"/ig,"");if(n.length>10){n=c(n);if(b===-1||!b){this.get_container().children("ul").empty().append(n.children())}else{b.children(".jstree-loading").removeClass("jstree-loading");b.append(n);b.data("jstree-is-loading",false)}if(i.clean_node){this.clean_node(b)}if(l){l.call(this)}}else{if(b&&b!==-1){b.children(".jstree-loading").removeClass("jstree-loading");b.data("jstree-is-loading",false);if(i.correct_state){b.removeClass("jstree-open jstree-closed").addClass("jstree-leaf");if(l){l.call(this)}}}else{if(i.correct_state){this.get_container().children("ul").empty();if(l){l.call(this)}}}}}},this))};i.ajax.context=this;i.ajax.error=k;i.ajax.success=a;if(!i.ajax.dataType){i.ajax.dataType="xml"}if(c.isFunction(i.ajax.url)){i.ajax.url=i.ajax.url.call(this,b)}if(c.isFunction(i.ajax.data)){i.ajax.data=i.ajax.data.call(this,b)}c.ajax(i.ajax);break}},parse_xml:function(f,a){var b=this._get_settings().xml_data;c.vakata.xslt(f,d[b.xsl],a)},get_xml:function(r,u,x,z,p){var a="",b=this._get_settings(),t=this,v,w,q,s,y;if(!r){r="flat"}if(!p){p=0}u=this._get_node(u);if(!u||u===-1){u=this.get_container().find("> ul > li")}x=c.isArray(x)?x:["id","class"];if(!p&&this.data.types&&c.inArray(b.types.type_attr,x)===-1){x.push(b.types.type_attr)}z=c.isArray(z)?z:[];if(!p){a+="<root>"}u.each(function(){a+="<item";q=c(this);c.each(x,function(e,f){a+=" "+f+'="'+(q.attr(f)||"").replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"")+'"'});if(q.hasClass("jstree-open")){a+=' state="open"'}if(q.hasClass("jstree-closed")){a+=' state="closed"'}if(r==="flat"){a+=' parent_id="'+p+'"'}a+=">";a+="<content>";s=q.children("a");s.each(function(){v=c(this);y=false;a+="<name";if(c.inArray("languages",b.plugins)!==-1){c.each(b.languages,function(f,e){if(v.hasClass(e)){a+=' lang="'+e+'"';y=e;return false}})}if(z.length){c.each(z,function(f,e){a+=" "+e+'="'+(v.attr(e)||"").replace(/jstree[^ ]*|$/ig,"")+'"'})}if(v.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length){a+=' icon="'+v.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"")+'"'}if(v.children("ins").get(0).style.backgroundImage.length){a+=' icon="'+v.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","")+'"'}a+=">";a+="<![CDATA["+t.get_text(v,y)+"]]>";a+="</name>"});a+="</content>";w=q[0].id;q=q.find("> ul > li");if(q.length){w=t.get_xml(r,q,x,z,w)}else{w=""}if(r=="nest"){a+=w}a+="</item>";if(r=="flat"){a+=w}});if(!p){a+="</root>"}return a}}})})(jQuery);(function(b){b.expr[":"].jstree_contains=function(f,e,a){return(f.textContent||f.innerText||"").toLowerCase().indexOf(a[3].toLowerCase())>=0};b.jstree.plugin("search",{__init:function(){this.data.search.str="";this.data.search.result=b()},defaults:{ajax:false,case_insensitive:false},_fn:{search:function(h,a){if(h===""){return}var j=this.get_settings().search,k=this,l=function(){},i=function(){};this.data.search.str=h;if(!a&&j.ajax!==false&&this.get_container().find(".jstree-closed:eq(0)").length>0){this.search.supress_callback=true;l=function(){};i=function(c,e,f){var d=this.get_settings().search.ajax.success;if(d){c=d.call(this,c,e,f)||c}this.data.search.to_open=c;this._search_open()};j.ajax.context=this;j.ajax.error=l;j.ajax.success=i;if(b.isFunction(j.ajax.url)){j.ajax.url=j.ajax.url.call(this,h)}if(b.isFunction(j.ajax.data)){j.ajax.data=j.ajax.data.call(this,h)}if(!j.ajax.data){j.ajax.data={search_string:h}}if(!j.ajax.dataType||/^json/.exec(j.ajax.dataType)){j.ajax.dataType="json"}b.ajax(j.ajax);return}if(this.data.search.result.length){this.clear_search()}this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+(j.case_insensitive?"jstree_contains":"contains")+"("+this.data.search.str+")");this.data.search.result.addClass("jstree-search").parents(".jstree-closed").each(function(){k.open_node(this,false,true)});this.__callback({nodes:this.data.search.result,str:h})},clear_search:function(a){this.data.search.result.removeClass("jstree-search");this.__callback(this.data.search.result);this.data.search.result=b()},_search_open:function(j){var g=this,a=true,h=[],i=[];if(this.data.search.to_open.length){b.each(this.data.search.to_open,function(d,c){if(c=="#"){return true}if(b(c).length&&b(c).is(".jstree-closed")){h.push(c)}else{i.push(c)}});if(h.length){this.data.search.to_open=i;b.each(h,function(d,c){g.open_node(c,function(){g._search_open(true)})});a=false}}if(a){this.search(this.data.search.str,true)}}}})})(jQuery);(function(b){b.vakata.context={cnt:b("<div id='vakata-contextmenu'>"),vis:false,tgt:false,par:false,func:false,data:false,show:function(a,d,m,n,o,r){var p=b.vakata.context.parse(a),q,h;if(!p){return}b.vakata.context.vis=true;b.vakata.context.tgt=d;b.vakata.context.par=r||d||null;b.vakata.context.data=o||null;b.vakata.context.cnt.html(p).css({visibility:"hidden",display:"block",left:0,top:0});q=b.vakata.context.cnt.height();h=b.vakata.context.cnt.width();if(m+h>b(document).width()){m=b(document).width()-(h+5);b.vakata.context.cnt.find("li > ul").addClass("right")}if(n+q>b(document).height()){n=n-(q+d[0].offsetHeight);b.vakata.context.cnt.find("li > ul").addClass("bottom")}b.vakata.context.cnt.css({left:m,top:n}).find("li:has(ul)").bind("mouseenter",function(f){var e=b(document).width(),g=b(document).height(),c=b(this).children("ul").show();if(e!==b(document).width()){c.toggleClass("right")}if(g!==b(document).height()){c.toggleClass("bottom")}}).bind("mouseleave",function(c){b(this).children("ul").hide()}).end().css({visibility:"visible"}).show();b(document).triggerHandler("context_show.vakata")},hide:function(){b.vakata.context.vis=false;b.vakata.context.cnt.attr("class","").hide();b(document).triggerHandler("context_hide.vakata")},parse:function(h,i){if(!h){return false}var g="",j=false,a=true;if(!i){b.vakata.context.func={}}g+="<ul>";b.each(h,function(d,c){if(!c){return true}b.vakata.context.func[d]=c.action;if(!a&&c.separator_before){g+="<li class='vakata-separator vakata-separator-before'></li>"}a=false;g+="<li class='"+(c._class||"")+(c._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ";if(c.icon&&c.icon.indexOf("/")===-1){g+=" class='"+c.icon+"' "}if(c.icon&&c.icon.indexOf("/")!==-1){g+=" style='background:url("+c.icon+") center center no-repeat;' "}g+=">&#160;</ins><a href='#' rel='"+d+"'>";if(c.submenu){g+="<span style='float:right;'>&raquo;</span>"}g+=c.label+"</a>";if(c.submenu){j=b.vakata.context.parse(c.submenu,true);if(j){g+=j}}g+="</li>";if(c.separator_after){g+="<li class='vakata-separator vakata-separator-after'></li>";a=true}});g=g.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,"");g+="</ul>";return g.length>10?g:false},exec:function(a){if(b.isFunction(b.vakata.context.func[a])){b.vakata.context.func[a].call(b.vakata.context.data,b.vakata.context.par);return true}else{return false}}};b(function(){var a="#vakata-contextmenu { display:none; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } #vakata-contextmenu ul { min-width:180px; *width:180px; } #vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } #vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } #vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } #vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } #vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } #vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } #vakata-contextmenu .right { right:100%; left:auto; } #vakata-contextmenu .bottom { bottom:-1px; top:auto; } #vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ";b.vakata.css.add_sheet({str:a});b.vakata.context.cnt.delegate("a","click",function(d){d.preventDefault()}).delegate("a","mouseup",function(d){if(!b(this).parent().hasClass("jstree-contextmenu-disabled")&&b.vakata.context.exec(b(this).attr("rel"))){b.vakata.context.hide()}else{b(this).blur()}}).delegate("a","mouseover",function(){b.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body");b(document).bind("mousedown",function(d){if(b.vakata.context.vis&&!b.contains(b.vakata.context.cnt[0],d.target)){b.vakata.context.hide()}});if(typeof b.hotkeys!=="undefined"){b(document).bind("keydown","up",function(f){if(b.vakata.context.vis){var e=b.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();if(!e.length){e=b.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last()}e.addClass("vakata-hover");f.stopImmediatePropagation();f.preventDefault()}}).bind("keydown","down",function(f){if(b.vakata.context.vis){var e=b.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();if(!e.length){e=b.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first()}e.addClass("vakata-hover");f.stopImmediatePropagation();f.preventDefault()}}).bind("keydown","right",function(d){if(b.vakata.context.vis){b.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover");d.stopImmediatePropagation();d.preventDefault()}}).bind("keydown","left",function(d){if(b.vakata.context.vis){b.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover");d.stopImmediatePropagation();d.preventDefault()}}).bind("keydown","esc",function(d){b.vakata.context.hide();d.preventDefault()}).bind("keydown","space",function(d){b.vakata.context.cnt.find(".vakata-hover").last().children("a").click();d.preventDefault()})}});b.jstree.plugin("contextmenu",{__init:function(){this.get_container().delegate("a","contextmenu.jstree",b.proxy(function(a){a.preventDefault();this.show_contextmenu(a.currentTarget,a.pageX,a.pageY)},this)).bind("show.jstree",b.proxy(function(){if(this.data.contextmenu){b.vakata.context.hide()}},this));b(document).bind("context_hide.vakata",b.proxy(function(){this.data.contextmenu=false},this))},defaults:{select_node:false,show_at_node:true,items:{create:{separator_before:false,separator_after:true,label:"Create",action:function(a){this.create(a)}},rename:{separator_before:false,separator_after:false,label:"Rename",action:function(a){this.rename(a)}},remove:{separator_before:false,icon:false,separator_after:false,label:"Delete",action:function(a){this.remove(a)}},ccp:{separator_before:true,icon:false,separator_after:false,label:"Edit",action:false,submenu:{cut:{separator_before:false,separator_after:false,label:"Cut",action:function(a){this.cut(a)}},copy:{separator_before:false,icon:false,separator_after:false,label:"Copy",action:function(a){this.copy(a)}},paste:{separator_before:false,icon:false,separator_after:false,label:"Paste",action:function(a){this.paste(a)}}}}}},_fn:{show_contextmenu:function(j,a,h){j=this._get_node(j);var k=this.get_settings().contextmenu,l=j.children("a:visible:eq(0)"),i=false;if(k.select_node&&this.data.ui&&!this.is_selected(j)){this.deselect_all();this.select_node(j,true)}if(k.show_at_node||typeof a==="undefined"||typeof h==="undefined"){i=l.offset();a=i.left;h=i.top+this.data.core.li_height}if(b.isFunction(k.items)){k.items=k.items.call(this,j)}this.data.contextmenu=true;b.vakata.context.show(k.items,l,a,h,this,j);if(this.data.themes){b.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}}})})(jQuery);(function(b){b.jstree.plugin("types",{__init:function(){var a=this._get_settings().types;this.data.types.attach_to=[];this.get_container().bind("init.jstree",b.proxy(function(){var h=a.types,i=a.type_attr,j="",g=this;b.each(h,function(d,c){b.each(c,function(e,f){if(!/^(max_depth|max_children|icon|valid_children)$/.test(e)){g.data.types.attach_to.push(e)}});if(!c.icon){return true}if(c.icon.image||c.icon.position){if(d=="default"){j+=".jstree-"+g.get_index()+" a > .jstree-icon { "}else{j+=".jstree-"+g.get_index()+" li["+i+"="+d+"] > a > .jstree-icon { "}if(c.icon.image){j+=" background-image:url("+c.icon.image+"); "}if(c.icon.position){j+=" background-position:"+c.icon.position+"; "}else{j+=" background-position:0 0; "}j+="} "}});if(j!=""){b.vakata.css.add_sheet({str:j})}},this)).bind("before.jstree",b.proxy(function(e,h){if(b.inArray(h.func,this.data.types.attach_to)!==-1){var i=this._get_settings().types.types,j=this._get_type(h.args[0]);if(((i[j]&&typeof i[j][h.func]!=="undefined")||(i["default"]&&typeof i["default"][h.func]!=="undefined"))&&!this._check(h.func,h.args[0])){e.stopImmediatePropagation();return false}}},this))},defaults:{max_children:-1,max_depth:-1,valid_children:"all",type_attr:"rel",types:{"default":{max_children:-1,max_depth:-1,valid_children:"all"}}},_fn:{_get_type:function(a){a=this._get_node(a);return(!a||!a.length)?false:a.attr(this._get_settings().types.type_attr)||"default"},set_type:function(d,a){a=this._get_node(a);return(!a.length||!d)?false:a.attr(this._get_settings().types.type_attr,d)},_check:function(l,m,n){var a=false,p=this._get_type(m),k=0,d=this,o=this._get_settings().types;if(m===-1){if(!!o[l]){a=o[l]}else{return}}else{if(p===false){return}if(!!o.types[p]&&!!o.types[p][l]){a=o.types[p][l]}else{if(!!o.types["default"]&&!!o.types["default"][l]){a=o.types["default"][l]}}}if(b.isFunction(a)){a=a.call(this,m)}if(l==="max_depth"&&m!==-1&&n!==false&&o.max_depth!==-2&&a!==0){this._get_node(m).children("a:eq(0)").parentsUntil(".jstree","li").each(function(c){if(o.max_depth!==-1&&o.max_depth-(c+1)<=0){a=0;return false}k=(c===0)?a:d._check(l,this,false);if(k!==-1&&k-(c+1)<=0){a=0;return false}if(k>=0&&(k-(c+1)<a||a<0)){a=k-(c+1)}if(o.max_depth>=0&&(o.max_depth-(c+1)<a||a<0)){a=o.max_depth-(c+1)}})}return a},check_move:function(){if(!this.__call_old()){return false}var a=this._get_move(),m=a.rt._get_settings().types,k=a.rt._check("max_children",a.cr),l=a.rt._check("max_depth",a.cr),o=a.rt._check("valid_children",a.cr),n=0,d=1,p;if(o==="none"){return false}if(b.isArray(o)&&a.ot&&a.ot._get_type){a.o.each(function(){if(b.inArray(a.ot._get_type(this),o)===-1){d=false;return false}});if(d===false){return false}}if(m.max_children!==-2&&k!==-1){n=a.cr===-1?this.get_container().children("> ul > li").not(a.o).length:a.cr.children("> ul > li").not(a.o).length;if(n+a.o.length>k){return false}}if(m.max_depth!==-2&&l!==-1){d=0;if(l===0){return false}if(typeof a.o.d==="undefined"){p=a.o;while(p.length>0){p=p.find("> ul > li");d++}a.o.d=d}if(l-a.o.d<0){return false}}return true},create_node:function(u,t,w,n,r,o){if(!o&&(r||this._is_loaded(u))){var v=(t&&t.match(/^before|after$/i)&&u!==-1)?this._get_parent(u):this._get_node(u),a=this._get_settings().types,p=this._check("max_children",v),q=this._check("max_depth",v),s=this._check("valid_children",v),x;if(!w){w={}}if(s==="none"){return false}if(b.isArray(s)){if(!w.attr||!w.attr[a.type_attr]){if(!w.attr){w.attr={}}w.attr[a.type_attr]=s[0]}else{if(b.inArray(w.attr[a.type_attr],s)===-1){return false}}}if(a.max_children!==-2&&p!==-1){x=v===-1?this.get_container().children("> ul > li").length:v.children("> ul > li").length;if(x+1>p){return false}}if(a.max_depth!==-2&&q!==-1&&(q-1)<0){return false}}return this.__call_old(true,u,t,w,n,r,o)}}})})(jQuery);(function(b){b.jstree.plugin("html_data",{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(true);this.data.html_data.original_container_html.find("li").andSelf().contents().filter(function(){return this.nodeType==3}).remove()},defaults:{data:false,ajax:false,correct_state:true},_fn:{load_node:function(g,a,h){var f=this;this.load_node_html(g,function(){f.__callback({obj:g});a.call(this)},h)},_is_loaded:function(a){a=this._get_node(a);return a==-1||!a||!this._get_settings().html_data.ajax||a.is(".jstree-open, .jstree-leaf")||a.children("ul").children("li").size()>0},load_node_html:function(k,a,m){var d,l=this.get_settings().html_data,n=function(){},j=function(){};k=this._get_node(k);if(k&&k!==-1){if(k.data("jstree-is-loading")){return}else{k.data("jstree-is-loading",true)}}switch(!0){case (!l.data&&!l.ajax):if(!k||k==-1){this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");this.clean_node()}if(a){a.call(this)}break;case (!!l.data&&!l.ajax)||(!!l.data&&!!l.ajax&&(!k||k===-1)):if(!k||k==-1){d=b(l.data);if(!d.is("ul")){d=b("<ul>").append(d)}this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");this.clean_node()}if(a){a.call(this)}break;case (!l.data&&!!l.ajax)||(!!l.data&&!!l.ajax&&k&&k!==-1):k=this._get_node(k);n=function(f,e,c){var g=this.get_settings().html_data.ajax.error;if(g){g.call(this,f,e,c)}if(k!=-1&&k.length){k.children(".jstree-loading").removeClass("jstree-loading");k.data("jstree-is-loading",false);if(e==="success"&&l.correct_state){k.removeClass("jstree-open jstree-closed").addClass("jstree-leaf")}}else{if(e==="success"&&l.correct_state){this.get_container().children("ul").empty()}}if(m){m.call(this)}};j=function(c,f,g){var e=this.get_settings().html_data.ajax.success;if(e){c=e.call(this,c,f,g)||c}if(c==""){return n.call(this,g,f,"")}if(c){c=b(c);if(!c.is("ul")){c=b("<ul>").append(c)}if(k==-1||!k){this.get_container().children("ul").empty().append(c.children()).find("li, a").filter(function(){return this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon")}else{k.children(".jstree-loading").removeClass("jstree-loading");k.append(c).find("li, a").filter(function(){return this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");k.data("jstree-is-loading",false)}this.clean_node(k);if(a){a.call(this)}}else{if(k&&k!==-1){k.children(".jstree-loading").removeClass("jstree-loading");k.data("jstree-is-loading",false);if(l.correct_state){k.removeClass("jstree-open jstree-closed").addClass("jstree-leaf");if(a){a.call(this)}}}else{if(l.correct_state){this.get_container().children("ul").empty();if(a){a.call(this)}}}}};l.ajax.context=this;l.ajax.error=n;l.ajax.success=j;if(!l.ajax.dataType){l.ajax.dataType="html"}if(b.isFunction(l.ajax.url)){l.ajax.url=l.ajax.url.call(this,k)}if(b.isFunction(l.ajax.data)){l.ajax.data=l.ajax.data.call(this,k)}b.ajax(l.ajax);break}}}});b.jstree.defaults.plugins.push("html_data")})(jQuery);(function(b){b.jstree.plugin("themeroller",{__init:function(){var a=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").delegate("a","mouseenter.jstree",function(){b(this).addClass(a.item_h)}).delegate("a","mouseleave.jstree",function(){b(this).removeClass(a.item_h)}).bind("open_node.jstree create_node.jstree",b.proxy(function(e,f){this._themeroller(f.rslt.obj)},this)).bind("loaded.jstree refresh.jstree",b.proxy(function(d){this._themeroller()},this)).bind("close_node.jstree",b.proxy(function(e,f){f.rslt.obj.children("ins").removeClass(a.opened).addClass(a.closed)},this)).bind("select_node.jstree",b.proxy(function(e,f){f.rslt.obj.children("a").addClass(a.item_a)},this)).bind("deselect_node.jstree deselect_all.jstree",b.proxy(function(e,f){this.get_container().find("."+a.item_a).removeClass(a.item_a).end().find(".jstree-clicked").addClass(a.item_a)},this)).bind("move_node.jstree",b.proxy(function(e,f){this._themeroller(f.rslt.o)},this))},__destroy:function(){var a=this._get_settings().themeroller,c=["ui-icon"];b.each(a,function(d,f){f=f.split(" ");if(f.length){c=c.concat(f)}});this.get_container().removeClass("ui-widget-content").find("."+c.join(", .")).removeClass(c.join(" "))},_fn:{_themeroller:function(d){var a=this._get_settings().themeroller;d=!d||d==-1?this.get_container():this._get_node(d).parent();d.find("li.jstree-closed > ins.jstree-icon").removeClass(a.opened).addClass("ui-icon "+a.closed).end().find("li.jstree-open > ins.jstree-icon").removeClass(a.closed).addClass("ui-icon "+a.opened).end().find("a").addClass(a.item).children("ins.jstree-icon").addClass("ui-icon "+a.item_icon)}},defaults:{opened:"ui-icon-triangle-1-se",closed:"ui-icon-triangle-1-e",item:"ui-state-default",item_h:"ui-state-hover",item_a:"ui-state-active",item_icon:"ui-icon-folder-collapsed"}});b(function(){var a=".jstree .ui-icon { overflow:visible; } .jstree a { padding:0 2px; }";b.vakata.css.add_sheet({str:a})})})(jQuery);(function(b){b.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",b.proxy(function(e,j){var a=[],k=true,i,l;if(j.func=="move_node"){if(j.args[4]===true){if(j.args[0].o&&j.args[0].o.length){j.args[0].o.children("a").each(function(){a.push(b(this).text().replace(/^\s+/g,""))});k=this._check_unique(a,j.args[0].np.find("> ul > li").not(j.args[0].o))}}}if(j.func=="create_node"){if(j.args[4]||this._is_loaded(j.args[0])){i=this._get_node(j.args[0]);if(j.args[1]&&(j.args[1]==="before"||j.args[1]==="after")){i=this._get_parent(j.args[0]);if(!i||i===-1){i=this.get_container()}}if(typeof j.args[2]==="string"){a.push(j.args[2])}else{if(!j.args[2]||!j.args[2].data){a.push(this._get_settings().core.strings.new_node)}else{a.push(j.args[2].data)}}k=this._check_unique(a,i.find("> ul > li"))}}if(j.func=="rename_node"){a.push(j.args[1]);l=this._get_node(j.args[0]);i=this._get_parent(l);if(!i||i===-1){i=this.get_container()}k=this._check_unique(a,i.find("> ul > li").not(l))}if(!k){e.stopPropagation();return false}},this))},_fn:{_check_unique:function(f,e){var a=[];e.children("a").each(function(){a.push(b(this).text().replace(/^\s+/g,""))});if(!a.length||!f.length){return true}a=a.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");if((a.length+f.length)!=a.concat(f).sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",").length){return false}return true},check_move:function(){if(!this.__call_old()){return false}var d=this._get_move(),a=[];if(d.o&&d.o.length){d.o.children("a").each(function(){a.push(b(this).text().replace(/^\s+/g,""))});return this._check_unique(a,d.np.find("> ul > li").not(d.o))}return true}}})})(jQuery);
